% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/furness.R
\name{furness}
\alias{furness}
\title{Furness (IPF) balancing for OD matrices}
\usage{
furness(
  od,
  od_type = c("matrix", "table"),
  o_target,
  d_target,
  tol = 1e-06,
  max_iter = 2000,
  scale_totals = c("d_to_o", "o_to_d"),
  verbose = FALSE,
  o_col = "ori",
  d_col = "des",
  t_col = "n"
)
}
\arguments{
\item{od}{OD matrix or table (seed).}

\item{od_type}{\code{"matrix"} or \code{"table"}.}

\item{o_target}{Target origin totals (vector).}

\item{d_target}{Target destination totals (vector).}

\item{tol}{Convergence tolerance.}

\item{max_iter}{Maximum number of iterations.}

\item{scale_totals}{What to do if \code{sum(o_target) != sum(d_target)}:
\code{"d_to_o"} rescales \code{d_target} to match \code{sum(o_target)}, and \code{"o_to_d"} rescales \code{o_target} to match \code{sum(d_target)}.}

\item{verbose}{If \code{TRUE}, prints progress.}

\item{o_col}{(table input) origin column name.}

\item{d_col}{(table input) destination column name.}

\item{t_col}{(table input) trips column name.}
}
\value{
A list with \code{od_balanced}, \code{converged}, \code{iterations}, and balancing factors.
}
\description{
Apply the Furness (iterative proportional fitting) algorithm to adjust an OD matrix so that
row sums and column sums match desired origin and destination totals.
}
