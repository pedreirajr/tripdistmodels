% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/gf_furness.R
\name{gf_furness}
\alias{gf_furness}
\title{Furness (IPF) growth factoring for OD data}
\usage{
gf_furness(
  od,
  od_type = c("matrix", "table"),
  origin_col = "ORI",
  dest_col = "DES",
  trips_col = "n",
  o_fut,
  d_fut,
  tol = 0.01,
  max_iter = 1000,
  scale_totals = c("none", "d_to_o", "o_to_d"),
  verbose = FALSE
)
}
\arguments{
\item{od}{OD input, whose structure must be coherent with \code{od_type}.
If \code{od_type = "matrix"}, \code{od} must be a numeric matrix (or a data.frame coercible to a numeric matrix).
If \code{od_type = "table"}, \code{od} must be a data.frame/tibble in long format with origin, destination,
and trips columns (duplicates are allowed and will be summed).}

\item{od_type}{Character. Type of \code{od} input: \code{"matrix"} or \code{"table"}.}

\item{origin_col, dest_col, trips_col}{Character. Column names in \code{od} when \code{od_type = "table"}.
Defaults are compatible with \code{dplyr::count(via, ORI, DES)} which yields \code{ORI}, \code{DES}, and \code{n}.}

\item{o_fut}{Numeric vector. Target future productions (row sums). If named, will be aligned to row names.}

\item{d_fut}{Numeric vector. Target future attractions (column sums). If named, will be aligned to col names.}

\item{tol}{Numeric. Convergence tolerance on maximum relative error (default 1e-2).}

\item{max_iter}{Integer. Maximum number of iterations (default 1000).}

\item{scale_totals}{Character. What to do if sum(o_fut) != sum(d_fut):
\code{"none"} (error), \code{"d_to_o"} (scale d_fut), or \code{"o_to_d"} (scale o_fut).}

\item{verbose}{Logical. If TRUE, prints iteration progress.}
}
\value{
A list with elements:
\describe{
\item{od_balanced}{Balanced OD matrix.}
\item{row_factors}{Final row factors (length nrow(od)).}
\item{col_factors}{Final column factors (length ncol(od)).}
\item{iterations}{Number of iterations performed.}
\item{converged}{Logical indicating convergence.}
\item{max_rel_error}{Final maximum relative error across rows and columns.}
\item{row_sums}{Row sums of balanced matrix.}
\item{col_sums}{Column sums of balanced matrix.}
}
}
\description{
Applies the Furness algorithm (iterative proportional fitting) to balance an
origin-destination (OD) dataset to match target future productions (origin totals)
and attractions (destination totals).
}
