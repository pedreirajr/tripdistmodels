% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/syn_gravitational.R
\name{syn_gravitational}
\alias{syn_gravitational}
\title{Synthetic doubly constrained gravitational model with TLFD calibration}
\usage{
syn_gravitational(
  od_base,
  cost,
  od_type = c("matrix", "table"),
  cost_type = c("matrix", "table"),
  origin_col = "ORI",
  dest_col = "DES",
  trips_col = "n",
  cost_col = "cost",
  o_target = NULL,
  d_target = NULL,
  friction = c("exp", "power", "combined"),
  bins = "auto",
  n_bins = 12L,
  bin_method = c("wquantile"),
  c_floor = NULL,
  tol = 1e-04,
  max_iter = 2000L,
  scale_totals = c("d_to_o", "o_to_d", "none"),
  verbose = FALSE
)
}
\arguments{
\item{od_base}{Base-period OD trips. Matrix or long table.}

\item{cost}{Cost matrix/table aligned to the same zoning system.}

\item{od_type}{Character. "matrix" or "table" for od_base.}

\item{cost_type}{Character. "matrix" or "table" for cost.}

\item{origin_col, dest_col, trips_col}{Column names when od_type = "table".}

\item{cost_col}{Column name for cost when cost_type = "table".}

\item{o_target, d_target}{Target productions and attractions (numeric vectors).
If NULL, use base margins from od_base.}

\item{friction}{Character. "exp", "power", or "combined".}

\item{bins}{Either "auto" or a numeric vector of cutpoints.}

\item{n_bins}{Integer. Used when bins = "auto".}

\item{bin_method}{Character. "wquantile" only for now.}

\item{c_floor}{Numeric or NULL. If NULL, computed automatically as \code{0.5 * min(cost[cost > 0])}.}

\item{tol, max_iter}{Passed to gf_furness for the final model. During optimization, a lighter IPF is used.}

\item{scale_totals}{Passed to gf_furness.}

\item{verbose}{Logical. Prints progress.}
}
\value{
An object of class "tripdistmodels_syn_gravity".
}
\description{
Builds a synthetic OD matrix using a doubly constrained gravity model.
Friction parameters are calibrated to match the observed trip length
frequency distribution (TLFD) from a base OD matrix.
}
\details{
Supported friction functions:
\itemize{
\item exponential: f(c) = exp(-beta * c)
\item power:       f(c) = c^(-n), with n > 0
\item combined:    f(c) = c^(n) * exp(-beta * c), with beta > 0 and n real (can be negative)
}
}
